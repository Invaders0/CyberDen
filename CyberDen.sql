-- phpMyAdmin SQL Dump
-- version 4.7.0
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: Feb 03, 2019 at 05:12 AM
-- Server version: 10.1.25-MariaDB
-- PHP Version: 5.6.31

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET AUTOCOMMIT = 0;
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `instinctme`
--

-- --------------------------------------------------------

--
-- Table structure for table `admin`
--

CREATE TABLE `admin` (
  `admin_id` int(11) NOT NULL,
  `admin_email` varchar(100) NOT NULL,
  `admin_name` varchar(100) NOT NULL,
  `password` varchar(100) NOT NULL,
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `admin`
--

INSERT INTO `admin` (`admin_id`, `admin_email`, `admin_name`, `password`, `time`) VALUES
(4, 'admin@gmail.com', 'kasireddy', '2f93473efece6e5b2dc83a81128c3263', '2018-06-06 00:29:53'),
(5, 'admin2@gmail.com', 'varma', '5e3fe9c4f4bc9346fef69cb04f86e9d7', '2018-06-06 00:30:17'),
(6, 'admin@instinctme.com', 'R&D Works', '2f93473efece6e5b2dc83a81128c3263', '2018-06-20 18:34:21');

-- --------------------------------------------------------

--
-- Table structure for table `chat`
--

CREATE TABLE `chat` (
  `sent_by` int(11) NOT NULL,
  `sent_to` int(11) NOT NULL,
  `msg` varchar(750) NOT NULL,
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `feedback`
--

CREATE TABLE `feedback` (
  `user_id` int(11) NOT NULL,
  `feedback` varchar(700) NOT NULL,
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `followers`
--

CREATE TABLE `followers` (
  `followed_by` int(11) NOT NULL,
  `following` int(11) NOT NULL,
  `status` int(11) NOT NULL,
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

--
-- Dumping data for table `followers`
--

INSERT INTO `followers` (`followed_by`, `following`, `status`, `time`) VALUES
(1, 27, 0, '2019-02-02 21:25:51');

-- --------------------------------------------------------

--
-- Table structure for table `friend_requests`
--

CREATE TABLE `friend_requests` (
  `sent_by` int(11) NOT NULL,
  `sent_to` int(11) NOT NULL,
  `status` int(11) NOT NULL DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `likes`
--

CREATE TABLE `likes` (
  `story_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `status` tinyint(1) DEFAULT '0',
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `likes`
--

INSERT INTO `likes` (`story_id`, `user_id`, `status`, `time`) VALUES
(8, 27, 0, '2019-02-02 20:53:30'),
(12, 27, 0, '2019-02-02 21:14:48'),
(13, 1, 1, '2019-02-03 01:03:32');

-- --------------------------------------------------------

--
-- Table structure for table `notifications`
--

CREATE TABLE `notifications` (
  `user_id` int(11) NOT NULL,
  `notification` varchar(750) NOT NULL,
  `seen` tinyint(1) NOT NULL DEFAULT '0',
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `stories`
--

CREATE TABLE `stories` (
  `story_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `title` varchar(100) NOT NULL,
  `story` text NOT NULL,
  `plain_story` text NOT NULL,
  `story_unique_hash` varchar(255) NOT NULL,
  `category` varchar(100) NOT NULL,
  `story_type` varchar(10) NOT NULL,
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `valid` tinyint(1) NOT NULL DEFAULT '1'
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `stories`
--

INSERT INTO `stories` (`story_id`, `user_id`, `title`, `story`, `plain_story`, `story_unique_hash`, `category`, `story_type`, `time`, `valid`) VALUES
(1, 4, 'About life by professor in a class', '&lt;p&gt;A professor stood before his class with some items on the table in front of him. When the class began, he picked up a very large and empty jar and proceeded to fill it with rocks.&lt;/p&gt;\n&lt;p&gt;He then asked the students if the jar was full. They agreed that it was.&lt;/p&gt;\n&lt;p&gt;So the professor then picked up a box of pebbles and poured them into the jar. He shook the jar lightly. The pebbles, of course, rolled into the open areas between the rocks.&lt;/p&gt;\n&lt;div style=&quot;float: right; margin: 10px 0 10px 10px;&quot;&gt;&amp;nbsp;&lt;/div&gt;\n&lt;p&gt;He then asked the students again if the jar was full. They agreed it was.&lt;/p&gt;\n&lt;p&gt;The professor picked up a box of sand and poured it into the jar. Of course, the sand filled up the remaining open areas of the jar.&lt;/p&gt;\n&lt;p&gt;He then asked once more if the jar was full. The students responded with a unanimous &amp;ldquo;Yes.&amp;rdquo;&lt;/p&gt;\n&lt;p&gt;&amp;ldquo;Now,&amp;rdquo; said the professor, &amp;ldquo;I want you to recognize that this jar represents your life. The rocks are the important things &amp;ndash; your family, your partner, your health, your children &amp;ndash; things that if everything else was lost and only they remained, your life would still be full. The pebbles are the other things that matter &amp;ndash; like your job, your house, your car. The sand is everything else, the small stuff.&amp;rdquo;&lt;/p&gt;\n&lt;p&gt;&amp;ldquo;If you put the sand into the jar first,&amp;rdquo; he continued, &amp;ldquo;there is no room for the pebbles or the rocks. The same goes for your life. If you spend all your time and energy on the small stuff, you will never have room for the things that are important to you. Pay attention to the things that are critical to your happiness. Play with your children. Take your partner out dancing. There will always be time to go to work, clean the house, give a dinner party, or fix the disposal.&amp;rdquo;&lt;/p&gt;\n&lt;p&gt;&amp;ldquo;Take care of the rocks first &amp;ndash; the things that really matter. Set your priorities. The rest is just sand.&amp;rdquo;&lt;/p&gt;\n&lt;p&gt;It\'s not mine, I read it somewhere.&lt;/p&gt;', 'A professor stood before his class with some items on the table in front of him. When the class began, he picked up a very large and empty jar and proceeded to fill it with rocks.\n\nHe then asked the students if the jar was full. They agreed that it was.\n\nSo the professor then picked up a box of pebbles and poured them into the jar. He shook the jar lightly. The pebbles, of course, rolled into the open areas between the rocks.\n\nHe then asked the students again if the jar was full. They agreed it was.\n\nThe professor picked up a box of sand and poured it into the jar. Of course, the sand filled up the remaining open areas of the jar.\n\nHe then asked once more if the jar was full. The students responded with a unanimous â€œYes.â€\n\nâ€œNow,â€ said the professor, â€œI want you to recognize that this jar represents your life. The rocks are the important things â€“ your family, your partner, your health, your children â€“ things that if everything else was lost and only they remained, your life would still be full. The pebbles are the other things that matter â€“ like your job, your house, your car. The sand is everything else, the small stuff.â€\n\nâ€œIf you put the sand into the jar first,â€ he continued, â€œthere is no room for the pebbles or the rocks. The same goes for your life. If you spend all your time and energy on the small stuff, you will never have room for the things that are important to you. Pay attention to the things that are critical to your happiness. Play with your children. Take your partner out dancing. There will always be time to go to work, clean the house, give a dinner party, or fix the disposal.â€\n\nâ€œTake care of the rocks first â€“ the things that really matter. Set your priorities. The rest is just sand.â€\n\nIt\'s not mine, I read it somewhere.', '5978259f0d26baaa2847b57b196405fc', 'web', 'others', '2018-09-18 04:51:09', 0),
(2, 18, '&quot;I LOVE YOU&quot; How it really feels.', '&lt;p&gt;My wife wanted me to take another woman out to dinner and a movie. She said, &amp;ldquo;I love you, but I know this other woman loves you and would love to spend some time with you.&amp;rdquo;&lt;br /&gt;&lt;br /&gt;The other woman that my wife wanted me to visit was my MOTHER, who has been a widow for 19 years, but the demands of my work and my three children had made it possible to visit her only occasionally. That night I called to invite her to go out for dinner and a movie.&amp;ldquo;What&amp;rsquo;s wrong, are you well?&amp;rdquo; she asked.I responded. &amp;ldquo;Just the two of us.&amp;rdquo; She thought about it for a moment, and then said, &amp;ldquo;I would like that very much.&amp;rdquo;&lt;br /&gt;&lt;br /&gt;I was a bit nervous. When I arrived at her house, I noticed that she, too, seemed to be nervous about our date. She waited in the door wearing the dress that she had worn to celebrate her last wedding anniversary. She smiled from a face that was as radiant as an angel&amp;rsquo;s.&lt;br /&gt;&lt;br /&gt;We went to a restaurant During the dinner, we had an agreeable conversation &amp;ndash; nothing extraordinary but catching up on recent events of each other&amp;rsquo;s life. We talked so much that we missed the movie.&lt;br /&gt;&lt;br /&gt;During the dinner, we had an agreeable conversation &amp;ndash; nothing extraordinary but catching up on recent events of each other&amp;rsquo;s life. We talked so much that we missed the movie.&lt;br /&gt;&lt;br /&gt;I returned to my home.&amp;ldquo;How was your dinner date?&amp;rdquo; asked my wife when I got home.I kissed her and said &quot;thank you sooo much for making such a wonderful thing happen in my life&quot;.she said &quot;I LOVE YOU&quot;.&lt;br /&gt;&lt;br /&gt;At that moment.I understood how some one saying &quot;I LOVE YOU&quot; to me really feels.&lt;/p&gt;\n&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Thank you God for giving me such a wife and family. &lt;br /&gt;&lt;br /&gt;--&amp;gt;Give our loved ones the time that they deserve. &lt;br /&gt;--&amp;gt;Nothing in life is more important than your family.&lt;/p&gt;', 'My wife wanted me to take another woman out to dinner and a movie. She said, â€œI love you, but I know this other woman loves you and would love to spend some time with you.â€\n\nThe other woman that my wife wanted me to visit was my MOTHER, who has been a widow for 19 years, but the demands of my work and my three children had made it possible to visit her only occasionally. That night I called to invite her to go out for dinner and a movie.â€œWhatâ€™s wrong, are you well?â€ she asked.I responded. â€œJust the two of us.â€ She thought about it for a moment, and then said, â€œI would like that very much.â€\n\nI was a bit nervous. When I arrived at her house, I noticed that she, too, seemed to be nervous about our date. She waited in the door wearing the dress that she had worn to celebrate her last wedding anniversary. She smiled from a face that was as radiant as an angelâ€™s.\n\nWe went to a restaurant During the dinner, we had an agreeable conversation â€“ nothing extraordinary but catching up on recent events of each otherâ€™s life. We talked so much that we missed the movie.\n\nDuring the dinner, we had an agreeable conversation â€“ nothing extraordinary but catching up on recent events of each otherâ€™s life. We talked so much that we missed the movie.\n\nI returned to my home.â€œHow was your dinner date?â€ asked my wife when I got home.I kissed her and said &quot;thank you sooo much for making such a wonderful thing happen in my life&quot;.she said &quot;I LOVE YOU&quot;.\n\nAt that moment.I understood how some one saying &quot;I LOVE YOU&quot; to me really feels.\n\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Thank you God for giving me such a wife and family.\n\n--&gt;Give our loved ones the time that they deserve.\n--&gt;Nothing in life is more important than your family.', '2d122986c9068f7f6bb97277ad2c8dd4', 'crypto', 'own', '2018-09-30 19:23:13', 0),
(3, 20, 'Forget the things by evening which makes you paralyzed', '&lt;p&gt;when I am having my Ph.D. It\'s my first class the professor shown the pen on the table and asked can I hold it. All of us answered that &quot;YES&quot;.&lt;br /&gt;&lt;br /&gt;He replied, &amp;ldquo;The absolute weight doesn&amp;rsquo;t matter. It depends on how long I hold it. If I hold it for a minute, it&amp;rsquo;s not a problem. If I hold it for an hour, I&amp;rsquo;ll have an ache in my arm. If I hold it for a day, my arm will feel numb and paralyzed. In each case, the weight of the pen doesn&amp;rsquo;t change, but the longer I hold it, the heavier it becomes.&amp;rdquo;&lt;br /&gt;&lt;br /&gt;He continued, &amp;ldquo;The stresses and worries in life are like that pen. Think about them for a while and nothing happens. Think about them a bit longer and they begin to hurt. And if you think about them all day long, you will feel paralyzed &amp;ndash; incapable of doing anything.&amp;rdquo;&lt;br /&gt;&lt;br /&gt;It&amp;rsquo;s important to remember to let go of your stresses. As early in the evening as you can, put all your burdens down. Don&amp;rsquo;t carry them through the evening and into the night. Remember to put the pen down!&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;', 'when I am having my Ph.D. It\'s my first class the professor shown the pen on the table and asked can I hold it. All of us answered that &quot;YES&quot;.\n\nHe replied, â€œThe absolute weight doesnâ€™t matter. It depends on how long I hold it. If I hold it for a minute, itâ€™s not a problem. If I hold it for an hour, Iâ€™ll have an ache in my arm. If I hold it for a day, my arm will feel numb and paralyzed. In each case, the weight of the pen doesnâ€™t change, but the longer I hold it, the heavier it becomes.â€\n\nHe continued, â€œThe stresses and worries in life are like that pen. Think about them for a while and nothing happens. Think about them a bit longer and they begin to hurt. And if you think about them all day long, you will feel paralyzed â€“ incapable of doing anything.â€\n\nItâ€™s important to remember to let go of your stresses. As early in the evening as you can, put all your burdens down. Donâ€™t carry them through the evening and into the night. Remember to put the pen down!', 'eebb8df8354f31ef4eeed7401d422e61', 're', 'own', '2018-10-03 10:28:05', 0),
(4, 21, 'I have learned', '&lt;p&gt;-that either you control your attitude or it controls you.&lt;br /&gt;&lt;br /&gt;-that it&amp;rsquo;s taking me a long time to become the person I want to be.&lt;br /&gt;&lt;br /&gt;-that no matter how good a friend is, they&amp;rsquo;re going to hurt you every once in a while and you must forgive them for that.&lt;br /&gt;&lt;br /&gt;-.that you can do something in an instant that will give you heartache for life.&lt;br /&gt;&lt;br /&gt;-that it&amp;rsquo;s not what you have in your life but who you have in your life that counts.&lt;br /&gt;&lt;br /&gt;-that you can do something in an instant that will give you heartache for life.&lt;br /&gt;&lt;br /&gt;-that you should always leave loved ones with loving words. It may be the last time you see them.&lt;br /&gt;&lt;br /&gt;-that heroes are the people who do what has to be done when it needs to be done, regardless of the consequences.&lt;br /&gt;&lt;br /&gt;-that my best friend and I can do anything or nothing and have the best time.&lt;br /&gt;&lt;br /&gt;-that sometimes the people you expect to kick you when you&amp;rsquo;re down will be the ones to help you get back up.&lt;br /&gt;&lt;br /&gt;-that true friendship continues to grow, even over the longest distance. Same goes for true love.&lt;br /&gt;&lt;br /&gt;-that maturity has to be more than how many birthdays you&amp;rsquo;ve celebrated.&lt;br /&gt;&lt;br /&gt;-that our background and circumstances may have influenced who we are, but we are responsible for who we become.&lt;br /&gt;&lt;br /&gt;-that a rich person is not the one who has the most but is one who needs the least.&lt;br /&gt;&lt;br /&gt;-that just because two people argue, it doesn&amp;rsquo;t mean they don&amp;rsquo;t love each other. And just because they don&amp;rsquo;t argue, it doesn&amp;rsquo;t mean they do.&lt;br /&gt;&lt;br /&gt;-that we don&amp;rsquo;t have to change friends if we understand that friends change.&lt;br /&gt;&lt;br /&gt;-that no matter how you try to protect your children, they will eventually get hurt and you will hurt in the process.&lt;br /&gt;&lt;br /&gt;-that even when you think you have no more to give when a friend cries out to you, you will find the strength to help.&lt;br /&gt;&lt;br /&gt;-that people will forget what you said, and people will forget what you did, but people will never forget how you made them feel.&lt;/p&gt;', '-that either you control your attitude or it controls you.\n\n-that itâ€™s taking me a long time to become the person I want to be.\n\n-that no matter how good a friend is, theyâ€™re going to hurt you every once in a while and you must forgive them for that.\n\n-.that you can do something in an instant that will give you heartache for life.\n\n-that itâ€™s not what you have in your life but who you have in your life that counts.\n\n-that you can do something in an instant that will give you heartache for life.\n\n-that you should always leave loved ones with loving words. It may be the last time you see them.\n\n-that heroes are the people who do what has to be done when it needs to be done, regardless of the consequences.\n\n-that my best friend and I can do anything or nothing and have the best time.\n\n-that sometimes the people you expect to kick you when youâ€™re down will be the ones to help you get back up.\n\n-that true friendship continues to grow, even over the longest distance. Same goes for true love.\n\n-that maturity has to be more than how many birthdays youâ€™ve celebrated.\n\n-that our background and circumstances may have influenced who we are, but we are responsible for who we become.\n\n-that a rich person is not the one who has the most but is one who needs the least.\n\n-that just because two people argue, it doesnâ€™t mean they donâ€™t love each other. And just because they donâ€™t argue, it doesnâ€™t mean they do.\n\n-that we donâ€™t have to change friends if we understand that friends change.\n\n-that no matter how you try to protect your children, they will eventually get hurt and you will hurt in the process.\n\n-that even when you think you have no more to give when a friend cries out to you, you will find the strength to help.\n\n-that people will forget what you said, and people will forget what you did, but people will never forget how you made them feel.', 'a758c82da101f147a3049f11bef89b89', 'forensics', 'own', '2018-10-03 10:45:16', 0),
(5, 22, 'Keep yourself in the CORRECT directoin', '&lt;p&gt;There may be days when you get up in the morning and things aren&amp;rsquo;t the way you had hoped they would be.&lt;br /&gt;&lt;br /&gt;That&amp;rsquo;s when you have to tell yourself that things will get better. There are times when people disappoint you and let you down.&lt;br /&gt;&lt;br /&gt;But those are the times when you must remind yourself to trust your own judgments and opinions, to keep your life focused on believing in yourself.&lt;br /&gt;&lt;br /&gt;There will be challenges to face and changes to make in your life, and it is up to you to accept them.&lt;br /&gt;&lt;br /&gt;Constantly keep yourself headed in the right direction for you. It may not be easy at times, but in those times of struggle you will find a stronger sense of who you are.&lt;br /&gt;&lt;br /&gt;So when the days come that are filled with frustration and unexpected responsibilities, remember to believe in yourself and all you want your life to be.&lt;br /&gt;&lt;br /&gt;Then one day You will be there at where you want to see yourself.&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; That\'s called success.&lt;/p&gt;', 'There may be days when you get up in the morning and things arenâ€™t the way you had hoped they would be.\n\nThatâ€™s when you have to tell yourself that things will get better. There are times when people disappoint you and let you down.\n\nBut those are the times when you must remind yourself to trust your own judgments and opinions, to keep your life focused on believing in yourself.\n\nThere will be challenges to face and changes to make in your life, and it is up to you to accept them.\n\nConstantly keep yourself headed in the right direction for you. It may not be easy at times, but in those times of struggle you will find a stronger sense of who you are.\n\nSo when the days come that are filled with frustration and unexpected responsibilities, remember to believe in yourself and all you want your life to be.\n\nThen one day You will be there at where you want to see yourself.\n\nÂ Â Â  Â Â Â  Â Â Â  That\'s called success.', 'ba76fec7da009f5a9aadc2fa9ff59ff4', 'pwn', 'own', '2018-10-03 10:49:38', 0),
(6, 27, 'cryptoooooo', '&lt;p&gt;hello this is just trial about crypto. hello this is just trial about crypto. that is the main purpose of the life.&lt;/p&gt;\n&lt;p&gt;hello this is just trial about crypto. hello this is just trial about crypto. that is the main purpose of the life.&lt;/p&gt;', 'hello this is just trial about crypto. hello this is just trial about crypto. that is the main purpose of the life.\n\nhello this is just trial about crypto. hello this is just trial about crypto. that is the main purpose of the life.', '992bd726b6002ab847e9d0295b49ff9d', 'crypto', 'own', '2019-02-02 18:09:01', 0),
(7, 27, 'crypto', '&lt;p&gt;crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats.&lt;/p&gt;', 'crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats. crypto means hiding the data inside the other formats.', '29fe173610e078e77220a75476f1f670', 'crypto', 'own', '2019-02-02 18:54:04', 1),
(8, 27, 'web', '&lt;p&gt;Web involves the solving the tricks in js, php vulnerabilities. This is only few ways where people can find the vulnerabilities. There are many ways where people can find the ways to find the vulnerabilities to hack the website.&lt;/p&gt;', 'Web involves the solving the tricks in js, php vulnerabilities. This is only few ways where people can find the vulnerabilities. There are many ways where people can find the ways to find the vulnerabilities to hack the website.', '6aaa1a78532c4e3d903fe877231f08f8', 'web', 'own', '2019-02-02 18:56:01', 1),
(9, 27, 'Pawning', '&lt;p&gt;Pawning is accessing the content of website through the other. This is just like logging into other systems. But anyway, these are not such easy tasks to do all the way. But there are things going on, where people are using these techniques in order to hack or inject the bugs into the system.&lt;/p&gt;', 'Pawning is accessing the content of website through the other. This is just like logging into other systems. But anyway, these are not such easy tasks to do all the way. But there are things going on, where people are using these techniques in order to hack or inject the bugs into the system.', 'b118df406123c4ac1355fdb097d66b71', 'pwn', 'own', '2019-02-02 18:58:28', 1),
(10, 27, 'Reverse Engineering', '&lt;p&gt;Reverse Engineering is the finding the solution in reverse manner. Here we are given solution first and then we need to find the question in reverse manner. It is so interesting and very powerful.&amp;nbsp; &amp;nbsp;Reverse Engineering is the finding the solution in reverse manner. Here we are given solution first and then we need to find the question in reverse manner. It is so interesting and very powerful.&amp;nbsp;&lt;/p&gt;', 'Reverse Engineering is the finding the solution in reverse manner. Here we are given solution first and then we need to find the question in reverse manner. It is so interesting and very powerful.Â  Â Reverse Engineering is the finding the solution in reverse manner. Here we are given solution first and then we need to find the question in reverse manner. It is so interesting and very powerful.Â ', 'e1b2345ee5473a5a9d637a3b03ccd1db', 're', 'own', '2019-02-02 19:03:40', 1),
(11, 27, 'Forensics', '&lt;p&gt;Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security.&amp;nbsp;&lt;/p&gt;', 'Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security. Forensics is also very powerful area where people use in cyber security.Â ', 'a78ab9e2798efb71918dbd3bf16ddd62', 'forensics', 'own', '2019-02-02 19:04:33', 1),
(12, 27, 'Misc', '&lt;p&gt;Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems. Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems. Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems. Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems.&amp;nbsp;&lt;/p&gt;', 'Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems. Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems. Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems. Misc means miscellaneous which contains problems of different ranges. It contains from low to high problems. It also contains very high problems.Â ', '73dd607d4eb42bbc9eea6ff3257aa970', 'misc', 'own', '2019-02-02 19:05:59', 1),
(13, 1, 'Programming', '&lt;p&gt;Programming involves the solving the problems regarding the programming languages and the vulnerabilities in them. Also, they are not easy to solve. To solve the programming based challenges, it required much more technical and programmable knowledge.&lt;/p&gt;', 'Programming involves the solving the problems regarding the programming languages and the vulnerabilities in them. Also, they are not easy to solve. To solve the programming based challenges, it required much more technical and programmable knowledge.', '8fb2393c91a95a23e5f49b54ba0dddf3', 'pro', 'own', '2019-02-02 21:35:58', 1);
INSERT INTO `stories` (`story_id`, `user_id`, `title`, `story`, `plain_story`, `story_unique_hash`, `category`, `story_type`, `time`, `valid`) VALUES
(14, 1, 'Shell Exploit', '&lt;h3 style=&quot;box-sizing: border-box; margin-bottom: 16px; font-size: 1.25em; line-height: 1.25; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; margin-top: 0px !important;&quot;&gt;messagebox (Attack and Defense)&lt;/h3&gt;\n&lt;hr style=&quot;box-sizing: content-box; height: 0.25em; background: #e1e4e8; border: 0px; margin: 24px 0px; padding: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot; /&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;messagebox is a tcp server which allows us to read and save files in directory named data.&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;service is running on port&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;5050&lt;/code&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Actually, it asks username and read/write the file with that username.&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;\n$ ./message\nEnter username: s1r1u5\n=======Menu======\n1. Save message\n2. View message\nYour choice: 1\nEnter size (&amp;lt;50): 30\nEnter input: Hello World\nInput saved successfully.\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;\n$ ./message\nEnter username: s1r1u5\n=======Menu======\n1. Save message\n2. View message\nYour choice: 2\nHello World\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Let us start our search for finding the vulnerabilities...&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Oh wait! Do we have to reverse engineer the binary?&amp;nbsp;ðŸ˜³&amp;nbsp;No, we got the source code there.&amp;nbsp;ðŸ˜Œ&amp;nbsp;Now our only task is to find the vulnerabilities in the source code&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/blob/master/Inctf_2018/messagebox/message.c&quot;&gt;message.c&lt;/a&gt;.&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;\nvoid readfile(char* filename)\n{\n  char* ptr;\n  char* temp=&quot;cat &quot;;\n  ptr=(char*)malloc(sizeof(char)*(strlen(temp)+strlen(filename)+1));\n  strcpy(ptr, temp);\n  strcat(ptr, filename);\n  system(ptr);\n  free(ptr);\n  printf(&quot;n&quot;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Are you able to find any vulnerabilities there????&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Yes, there it is&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;cat&lt;/span&gt;&amp;nbsp;and&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;system&lt;/span&gt;&amp;nbsp;call&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;To read the file called filename from the local directory it is using cat command. Here filename is nothing but the username which we have given.&lt;/p&gt;\n&lt;h3 style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 24px; font-size: 1.25em; line-height: 1.25; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\';&quot;&gt;&lt;a id=&quot;user-content-bug-1&quot; class=&quot;anchor&quot; style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none; float: left; line-height: 1; margin-left: -20px; padding-right: 4px;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/tree/master/Inctf_2018/messagebox#bug-1&quot; aria-hidden=&quot;true&quot;&gt;&lt;/a&gt;Bug 1&lt;/h3&gt;\n&lt;p&gt;&lt;span style=&quot;color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;username = *&lt;/span&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;exploit :&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/blob/master/Inctf_2018/messagebox/exp.py&quot;&gt;exp.py&lt;/a&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;what if we give the username as *. It just read all the files in the current directory&lt;/p&gt;\n&lt;hr style=&quot;box-sizing: content-box; height: 0.25em; background: #e1e4e8; border: 0px; margin: 24px 0px; padding: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot; /&gt;\n&lt;h3 style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 24px; font-size: 1.25em; line-height: 1.25; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\';&quot;&gt;&lt;a id=&quot;user-content-bug-2&quot; class=&quot;anchor&quot; style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none; float: left; line-height: 1; margin-left: -20px; padding-right: 4px;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/tree/master/Inctf_2018/messagebox#bug-2&quot; aria-hidden=&quot;true&quot;&gt;&lt;/a&gt;Bug 2&lt;/h3&gt;\n&lt;p&gt;&lt;span style=&quot;color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;username = *; sh&lt;/span&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;exploit :&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/blob/master/Inctf_2018/messagebox/exp3.py&quot;&gt;exp3.py&lt;/a&gt;&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;\ncat *; sh\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;we can get the shell by ending first command by&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;;&lt;/span&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Patch for above bugs : Rather than using dangerous system call, we can just read the files in the directory by file handling in C language.&lt;/p&gt;\n&lt;hr style=&quot;box-sizing: content-box; height: 0.25em; background: #e1e4e8; border: 0px; margin: 24px 0px; padding: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot; /&gt;\n&lt;h3 style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 24px; font-size: 1.25em; line-height: 1.25; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\';&quot;&gt;&lt;a id=&quot;user-content-bug-3&quot; class=&quot;anchor&quot; style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none; float: left; line-height: 1; margin-left: -20px; padding-right: 4px;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/tree/master/Inctf_2018/messagebox#bug-3&quot; aria-hidden=&quot;true&quot;&gt;&lt;/a&gt;Bug 3&lt;/h3&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;\nvoid view(char* user)\n{\n  int len;\n  int flag=0;\n  listdir();\n  for(int i=0; i &amp;lt; count ;i++)\n  {\n    len=strlen(user);\n    if(!strncmp(user, files[i], len))\n    {\n      readfile(files[i]);\n      flag=1;\n    }\n  }\n  if(!flag)\n    puts(&quot;No such user&quot;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Another bug if we give empty username as input then strncmp(&quot;&quot;,files[i],0) is always 0.&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;exploit :&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/blob/master/Inctf_2018/messagebox/exp2.py&quot;&gt;exp2.py&lt;/a&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Patch : Simple patch can be user input must be some length.&lt;/p&gt;\n&lt;hr style=&quot;box-sizing: content-box; height: 0.25em; background: #e1e4e8; border: 0px; margin: 24px 0px; padding: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot; /&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Here is the final bug and my favorite one&lt;/p&gt;\n&lt;h3 style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 24px; font-size: 1.25em; line-height: 1.25; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\';&quot;&gt;&lt;a id=&quot;user-content-bug-4-bufferoverflow&quot; class=&quot;anchor&quot; style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none; float: left; line-height: 1; margin-left: -20px; padding-right: 4px;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/tree/master/Inctf_2018/messagebox#bug-4-bufferoverflow&quot; aria-hidden=&quot;true&quot;&gt;&lt;/a&gt;Bug 4 (Bufferoverflow)&lt;/h3&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;void save(char* user)\n{\n&amp;nbsp;&amp;nbsp;listdir(); //storing the list of files in the data directory in the global variable named files&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;&amp;nbsp;&amp;nbsp;char* temp=(char*)malloc(50&lt;em style=&quot;box-sizing: border-box;&quot;&gt;sizeof(char)); //allocating 50 bytes on the heap.\n&amp;nbsp;&amp;nbsp;bool&lt;/em&gt; exist=(bool*)malloc(count*sizeof(bool)); //allocating n bytes on the heap, here n is number of files in the directory.&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;&amp;nbsp;&amp;nbsp;int size=0;&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;&amp;nbsp;&amp;nbsp;if(!check_existence(user,exist))\n&amp;nbsp;&amp;nbsp;{\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;FILE *fp;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fp=fopen(user, &quot;w&quot;);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;printf(&quot;Enter size ( &amp;lt; 50): &quot;); //wtf\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;size=getint();\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(size &amp;gt; = 50) // we need to somehow bypass this constraint\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;puts(&quot;Sorry, Your data is too big!&quot;);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;exit(0);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;printf(&quot;Enter input: &quot;);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;get_inp(temp, size);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fprintf(fp, &quot;%s&quot;, temp);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;fclose(fp);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;puts(&quot;Input saved successfully.&quot;);\n&amp;nbsp;&amp;nbsp;}&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;&amp;nbsp;&amp;nbsp;else\n&amp;nbsp;&amp;nbsp;{\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;puts(&quot;save: Permission denied. You can only view :- &quot;);\n&amp;nbsp;&amp;nbsp;}&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;&amp;nbsp;&amp;nbsp;for(int i=0;i &amp;lt; count;i++)\n&amp;nbsp;&amp;nbsp;{\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(exist[i])  //change the value of exist[i] other than 0, so we can read the files in the directory.\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;readfile(files[i]);\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}\n&amp;nbsp;&amp;nbsp;}&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;&amp;nbsp;&amp;nbsp;return;\n}&lt;/p&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 16px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; color: #24292e;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; background: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; word-break: normal; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 11.56px; background-color: transparent; border-radius: 3px; margin: 0px; padding: 0px; border: 0px; display: inline; line-height: inherit; overflow: visible; overflow-wrap: normal;&quot;&gt;&lt;/code&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;&amp;nbsp;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;If you look at keenly, the allocation of&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;exist(bool)&lt;/span&gt;&amp;nbsp;is just after the allocation of&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;temp&lt;/span&gt;. So overflowing temp, we can overwrite the exist array with any value other than 0.&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;There is a constrain that the size of temp must be &amp;lt; 50. So we can bypass this by giving size = -1 (0xffffffff).&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Now we can use pwn tools to do the automation stuff.&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;exploit :&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/51r1u5/ctf_writeups/blob/master/Inctf_2018/messagebox/exp4.py&quot;&gt;exp4.py&lt;/a&gt;&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;Patch: It is just enough to change unsigned int to int in the getint function.&lt;/p&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-top: 0px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px; margin-bottom: 0px !important;&quot;&gt;ðŸ˜Œ&lt;/p&gt;', 'messagebox (Attack and Defense)\nmessagebox is a tcp server which allows us to read and save files in directory named data.\n\nservice is running on portÂ 5050\n\nActually, it asks username and read/write the file with that username.\n\n\n$ ./message\nEnter username: s1r1u5\n=======Menu======\n1. Save message\n2. View message\nYour choice: 1\nEnter size (&lt;50): 30\nEnter input: Hello World\nInput saved successfully.\n\n\n$ ./message\nEnter username: s1r1u5\n=======Menu======\n1. Save message\n2. View message\nYour choice: 2\nHello World\n\nLet us start our search for finding the vulnerabilities...\n\nOh wait! Do we have to reverse engineer the binary?Â ðŸ˜³Â No, we got the source code there.Â ðŸ˜ŒÂ Now our only task is to find the vulnerabilities in the source codeÂ message.c.\n\n\nvoid readfile(char* filename)\n{\n  char* ptr;\n  char* temp=&quot;cat &quot;;\n  ptr=(char*)malloc(sizeof(char)*(strlen(temp)+strlen(filename)+1));\n  strcpy(ptr, temp);\n  strcat(ptr, filename);\n  system(ptr);\n  free(ptr);\n  printf(&quot;n&quot;);\n}\nAre you able to find any vulnerabilities there????\n\nYes, there it isÂ catÂ andÂ systemÂ call\n\nTo read the file called filename from the local directory it is using cat command. Here filename is nothing but the username which we have given.\n\nBug 1\nusername = *\n\nexploit :Â exp.py\n\nwhat if we give the username as *. It just read all the files in the current directory\n\nBug 2\nusername = *; sh\n\nexploit :Â exp3.py\n\n\ncat *; sh\n\nwe can get the shell by ending first command byÂ ;\n\nPatch for above bugs : Rather than using dangerous system call, we can just read the files in the directory by file handling in C language.\n\nBug 3\n\nvoid view(char* user)\n{\n  int len;\n  int flag=0;\n  listdir();\n  for(int i=0; i &lt; count ;i++)\n  {\n    len=strlen(user);\n    if(!strncmp(user, files[i], len))\n    {\n      readfile(files[i]);\n      flag=1;\n    }\n  }\n  if(!flag)\n    puts(&quot;No such user&quot;);\n}\nAnother bug if we give empty username as input then strncmp(&quot;&quot;,files[i],0) is always 0.\n\nexploit :Â exp2.py\n\nPatch : Simple patch can be user input must be some length.\n\nHere is the final bug and my favorite one\n\nBug 4 (Bufferoverflow)\n\nvoid save(char* user)\n{\nÂ Â listdir(); //storing the list of files in the data directory in the global variable named files\n\n\nÂ Â char* temp=(char*)malloc(50sizeof(char)); //allocating 50 bytes on the heap.\nÂ Â bool exist=(bool*)malloc(count*sizeof(bool)); //allocating n bytes on the heap, here n is number of files in the directory.\n\n\nÂ Â int size=0;\n\n\nÂ Â if(!check_existence(user,exist))\nÂ Â {\nÂ Â Â Â FILE *fp;\nÂ Â Â Â fp=fopen(user, &quot;w&quot;);\nÂ Â Â Â printf(&quot;Enter size ( &lt; 50): &quot;); //wtf\nÂ Â Â Â size=getint();\nÂ Â Â Â if(size &gt; = 50) // we need to somehow bypass this constraint\nÂ Â Â Â {\nÂ Â Â Â Â Â puts(&quot;Sorry, Your data is too big!&quot;);\nÂ Â Â Â Â Â exit(0);\nÂ Â Â Â }\nÂ Â Â Â printf(&quot;Enter input: &quot;);\nÂ Â Â Â get_inp(temp, size);\nÂ Â Â Â fprintf(fp, &quot;%s&quot;, temp);\nÂ Â Â Â fclose(fp);\nÂ Â Â Â puts(&quot;Input saved successfully.&quot;);\nÂ Â }\n\n\nÂ Â else\nÂ Â {\nÂ Â Â Â puts(&quot;save: Permission denied. You can only view :- &quot;);\nÂ Â }\n\n\nÂ Â for(int i=0;i &lt; count;i++)\nÂ Â {\nÂ Â Â Â if(exist[i])  //change the value of exist[i] other than 0, so we can read the files in the directory.\nÂ Â Â Â {\nÂ Â Â Â Â Â readfile(files[i]);\nÂ Â Â Â }\nÂ Â }\n\n\nÂ Â return;\n}\n\n\n\nIf you look at keenly, the allocation ofÂ exist(bool)Â is just after the allocation ofÂ temp. So overflowing temp, we can overwrite the exist array with any value other than 0.\n\nThere is a constrain that the size of temp must be &lt; 50. So we can bypass this by giving size = -1 (0xffffffff).\n\nNow we can use pwn tools to do the automation stuff.\n\nexploit :Â exp4.py\n\nPatch: It is just enough to change unsigned int to int in the getint function.\n\nðŸ˜Œ', '3d657b6e6efe5cfcd0a1ce1d85284f30', 'pwn', 'own', '2019-02-03 02:56:39', 1);
INSERT INTO `stories` (`story_id`, `user_id`, `title`, `story`, `plain_story`, `story_unique_hash`, `category`, `story_type`, `time`, `valid`) VALUES
(15, 1, 'authrw', '&lt;h1 style=&quot;box-sizing: border-box; line-height: 1.25; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; margin: 0px !important 0px 16px 0px;&quot;&gt;authrw&lt;/h1&gt;\n&lt;ul style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; padding-left: 2em; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;li style=&quot;box-sizing: border-box;&quot;&gt;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/tree/master/authrw-Crypto%20Challenge/authrw&quot;&gt;authrw&lt;/a&gt;&amp;nbsp;is a&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;Crypto Challenge&lt;/span&gt;&amp;nbsp;given in InCTF-2018 Finals Attack and Defence&lt;/li&gt;\n&lt;li style=&quot;box-sizing: border-box; margin-top: 0.25em;&quot;&gt;It uses the&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;AES 128-bit CBC mode Encrytion&lt;/code&gt;.&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;IV(16 bytes)&lt;/code&gt;&amp;nbsp;is given in iv.txt but we have to&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;generate the key&lt;/span&gt;&amp;nbsp;using&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/blob/master/authrw-Crypto%20Challenge/authrw/generate_key.py&quot;&gt;generate_key.py&lt;/a&gt;&amp;nbsp;which takes the Team password as input.The generated Key is&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;md5 hash of Team password&lt;/code&gt;.&lt;/li&gt;\n&lt;li style=&quot;box-sizing: border-box; margin-top: 0.25em;&quot;&gt;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;It Runs a Crypto Service in which it has&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;Login&lt;/code&gt;&amp;nbsp;and&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;Register&lt;/code&gt;&amp;nbsp;services&lt;/span&gt;&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/1.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;box-sizing: content-box; border-style: none; max-width: 100%;&quot; title=&quot;Service&quot; src=&quot;https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/1.png&quot; alt=&quot;Login,Register&quot; /&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 24px; font-size: 1.25em; line-height: 1.25; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\';&quot;&gt;&lt;a id=&quot;user-content-1---register&quot; class=&quot;anchor&quot; style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none; float: left; line-height: 1; margin-left: -20px; padding-right: 4px;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/tree/master/authrw-Crypto%20Challenge#1---register&quot; aria-hidden=&quot;true&quot;&gt;&lt;/a&gt;1 - Register&lt;/h3&gt;\n&lt;div class=&quot;highlight highlight-source-python&quot; style=&quot;box-sizing: border-box; margin-bottom: 16px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 0px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; word-break: normal;&quot;&gt;    &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;pl-en&quot; style=&quot;box-sizing: border-box; color: #6f42c1;&quot;&gt;register&lt;/span&gt;(&lt;span class=&quot;pl-smi&quot; style=&quot;box-sizing: border-box;&quot;&gt;username&lt;/span&gt;):\n        &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;global&lt;/span&gt; iv, key\n        username &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;username=&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;+&lt;/span&gt; username &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;:role=ordinary&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;\n        cookie &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;=&lt;/span&gt; iv &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;+&lt;/span&gt; _encrypt(username, iv, key)\n        &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;return&lt;/span&gt; cookie.encode(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;hex&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;)&lt;/pre&gt;\n&lt;/div&gt;\n&lt;ul style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; padding-left: 2em; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;li style=&quot;box-sizing: border-box;&quot;&gt;For the Register it asks the user for&amp;nbsp;&lt;span style=&quot;box-sizing: border-box; font-weight: 600;&quot;&gt;username&lt;/span&gt;&amp;nbsp;(username != \'admin\')&lt;/li&gt;\n&lt;li style=&quot;box-sizing: border-box; margin-top: 0.25em;&quot;&gt;Then it Encrypts the&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;pad(&quot;username=input():role=ordinary&quot;)&lt;/code&gt;&amp;nbsp;with AES CBC 128-bit Encryption&lt;/li&gt;\n&lt;li style=&quot;box-sizing: border-box; margin-top: 0.25em;&quot;&gt;After that It returns a cookie which is&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;&quot;IV+Cipher_text&quot;.encode(\'hex\')&lt;/code&gt;&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/R.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;box-sizing: content-box; border-style: none; max-width: 100%;&quot; title=&quot;Register&quot; src=&quot;https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/R.png&quot; alt=&quot;Register&quot; /&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;blockquote style=&quot;box-sizing: border-box; margin: 0px 0px 16px; border-left: 0.25em solid #dfe2e5; color: #6a737d; padding: 0px 1em; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 0px; margin-top: 0px;&quot;&gt;Analyze the cookie&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/S.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;box-sizing: content-box; border-style: none; max-width: 100%;&quot; title=&quot;Register&quot; src=&quot;https://raw.githubusercontent.com/Ajay-Aj-00/Test/master/Images/S.png&quot; alt=&quot;Register&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 24px; font-size: 1.25em; line-height: 1.25; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\';&quot;&gt;&lt;a id=&quot;user-content-2---login&quot; class=&quot;anchor&quot; style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none; float: left; line-height: 1; margin-left: -20px; padding-right: 4px;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/tree/master/authrw-Crypto%20Challenge#2---login&quot; aria-hidden=&quot;true&quot;&gt;&lt;/a&gt;2 - Login&lt;/h3&gt;\n&lt;div class=&quot;highlight highlight-source-python&quot; style=&quot;box-sizing: border-box; margin-bottom: 16px; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;pre style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; margin-bottom: 0px; margin-top: 0px; overflow-wrap: normal; background-color: #f6f8fa; border-radius: 3px; line-height: 1.45; overflow: auto; padding: 16px; word-break: normal;&quot;&gt;    &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;pl-en&quot; style=&quot;box-sizing: border-box; color: #6f42c1;&quot;&gt;login&lt;/span&gt;(&lt;span class=&quot;pl-smi&quot; style=&quot;box-sizing: border-box;&quot;&gt;cookie&lt;/span&gt;):\n        cookie &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;=&lt;/span&gt; cookie.decode(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;hex&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;)\n        iv &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;=&lt;/span&gt; cookie[:&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;16&lt;/span&gt;]\n        &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;global&lt;/span&gt; key\n        ciphertext &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;=&lt;/span&gt; cookie[&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;16&lt;/span&gt;:]\n        plaintext &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;=&lt;/span&gt; _decrypt(ciphertext, iv, key)\n        plaintext &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;=&lt;/span&gt; plaintext.split(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;:&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;)\n        &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;len&lt;/span&gt;(plaintext) &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;2&lt;/span&gt;\n        &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;assert&lt;/span&gt; plaintext[&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;0&lt;/span&gt;][:&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;9&lt;/span&gt;] &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;username=&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;\n        &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;assert&lt;/span&gt; plaintext[&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;1&lt;/span&gt;][:&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;5&lt;/span&gt;] &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;role=&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;\n        &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;return&lt;/span&gt; (plaintext[&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;9&lt;/span&gt;:], plaintext[&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;5&lt;/span&gt;:])\n        &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: #005cc5;&quot;&gt;print&lt;/span&gt; colors.red &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: #032f62;&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;[-] Invalid cookie!&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: #d73a49;&quot;&gt;+&lt;/span&gt; colors.reset&lt;/pre&gt;\n&lt;/div&gt;\n&lt;ul style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; padding-left: 2em; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;li style=&quot;box-sizing: border-box;&quot;&gt;For the Login it asks for cookie(Provided after registration)&lt;/li&gt;\n&lt;li style=&quot;box-sizing: border-box; margin-top: 0.25em;&quot;&gt;Then It Decrypts it , unpad it &amp;gt;&amp;gt;&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;username=(username):role=ordinary&lt;/code&gt;&amp;nbsp;and It parses the string and saves username and role in user , role variables&lt;/li&gt;\n&lt;/ul&gt;\n&lt;blockquote style=&quot;box-sizing: border-box; margin: 0px 0px 16px; border-left: 0.25em solid #dfe2e5; color: #6a737d; padding: 0px 1em; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 0px; margin-top: 0px;&quot;&gt;After All these There are Three conditions to check the&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;user,role values&lt;/code&gt;&lt;br style=&quot;box-sizing: border-box;&quot; /&gt;1&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;user==\'admin\' and role==\'ordinary\'&lt;/code&gt;&lt;br style=&quot;box-sizing: border-box;&quot; /&gt;2&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;user==\'admin\' and role==\'admin\'&lt;/code&gt;&lt;br style=&quot;box-sizing: border-box;&quot; /&gt;3&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;else condition:&lt;/code&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;ul style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 0px; padding-left: 2em; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;li style=&quot;box-sizing: border-box;&quot;&gt;Here Comes the Problem We cant give the \'admin\' as username while registering Then we cant get user as \'admin\' after decryption so we move to else condition.&lt;/li&gt;\n&lt;li style=&quot;box-sizing: border-box; margin-top: 0.25em;&quot;&gt;But they have some Vullnerabilities. See the Below links(&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: 13.6px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;Exploiting the Vulnerabilities&lt;/code&gt;)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;blockquote style=&quot;box-sizing: border-box; margin: 0px 0px 16px; border-left: 0.25em solid #dfe2e5; color: #6a737d; padding: 0px 1em; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px;&quot;&gt;\n&lt;p style=&quot;box-sizing: border-box; margin-bottom: 0px; margin-top: 0px;&quot;&gt;In Those 3 conditions&lt;br style=&quot;box-sizing: border-box;&quot; /&gt;1 Provides us Reading rights of Flag(&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/tree/master/authrw-Crypto%20Challenge/authR_Exploit&quot;&gt;Reading authorization&lt;/a&gt;)&lt;br style=&quot;box-sizing: border-box;&quot; /&gt;2 Provides us Writing rights of Flag(&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/tree/master/authrw-Crypto%20Challenge/authW_Exploit&quot;&gt;Writing authorization&lt;/a&gt;)&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h2 style=&quot;box-sizing: border-box; margin-bottom: 16px; margin-top: 24px; line-height: 1.25; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\';&quot;&gt;&lt;a id=&quot;user-content-now-the-name-authrw-is-making-sense-authrization-for-reading-and-writing&quot; class=&quot;anchor&quot; style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none; float: left; line-height: 1; margin-left: -20px; padding-right: 4px;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/tree/master/authrw-Crypto%20Challenge#now-the-name-authrw-is-making-sense-authrization-for-reading-and-writing&quot; aria-hidden=&quot;true&quot;&gt;&lt;/a&gt;Now the name&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: inherit; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;authrw&lt;/code&gt;&amp;nbsp;is making sense&amp;nbsp;&lt;code style=&quot;box-sizing: border-box; font-family: SFMono-Regular, Consolas, \'Liberation Mono\', Menlo, Courier, monospace; font-size: inherit; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; margin: 0px; padding: 0.2em 0.4em;&quot;&gt;authrization for Reading and Writing&lt;/code&gt;&lt;/h2&gt;\n&lt;ul style=&quot;box-sizing: border-box; margin-top: 0px; padding-left: 2em; color: #24292e; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Helvetica, Arial, sans-serif, \'Apple Color Emoji\', \'Segoe UI Emoji\', \'Segoe UI Symbol\'; font-size: 16px; margin-bottom: 0px !important;&quot;&gt;\n&lt;li style=&quot;box-sizing: border-box;&quot;&gt;Defending our services is also important. So we have to&amp;nbsp;&lt;a style=&quot;box-sizing: border-box; background-color: transparent; color: #0366d6; text-decoration-line: none;&quot; href=&quot;https://github.com/D1r3Wolf/InCTF-2018-Finals/tree/master/authrw-Crypto%20Challenge/patch&quot;&gt;patch&lt;/a&gt;&amp;nbsp;the Vulnerabilities.&lt;/li&gt;\n&lt;/ul&gt;', 'authrw\nauthrwÂ is aÂ Crypto ChallengeÂ given in InCTF-2018 Finals Attack and Defence\nIt uses theÂ AES 128-bit CBC mode Encrytion.IV(16 bytes)Â is given in iv.txt but we have toÂ generate the keyÂ usingÂ generate_key.pyÂ which takes the Team password as input.The generated Key isÂ md5 hash of Team password.\nIt Runs a Crypto Service in which it hasÂ LoginÂ andÂ RegisterÂ servicesÂ \n1 - Register\n    def register(username):\n        global iv, key\n        username = &quot;username=&quot; + username + &quot;:role=ordinary&quot;\n        cookie = iv + _encrypt(username, iv, key)\n        return cookie.encode(&quot;hex&quot;)\nFor the Register it asks the user forÂ usernameÂ (username != \'admin\')\nThen it Encrypts theÂ pad(&quot;username=input():role=ordinary&quot;)Â with AES CBC 128-bit Encryption\nAfter that It returns a cookie which isÂ &quot;IV+Cipher_text&quot;.encode(\'hex\')Â \nAnalyze the cookieÂ \n\n2 - Login\n    def login(cookie):\n        cookie = cookie.decode(&quot;hex&quot;)\n        iv = cookie[:16]\n        global key\n        ciphertext = cookie[16:]\n        plaintext = _decrypt(ciphertext, iv, key)\n        plaintext = plaintext.split(&quot;:&quot;)\n        assert len(plaintext) == 2\n        assert plaintext[0][:9] == &quot;username=&quot;\n        assert plaintext[1][:5] == &quot;role=&quot;\n        return (plaintext[0][9:], plaintext[1][5:])\n        print colors.red + &quot;[-] Invalid cookie!&quot; + colors.reset\nFor the Login it asks for cookie(Provided after registration)\nThen It Decrypts it , unpad it &gt;&gt;Â username=(username):role=ordinaryÂ and It parses the string and saves username and role in user , role variables\nAfter All these There are Three conditions to check theÂ user,role values\n1Â user==\'admin\' and role==\'ordinary\'\n2Â user==\'admin\' and role==\'admin\'\n3Â else condition:\n\nHere Comes the Problem We cant give the \'admin\' as username while registering Then we cant get user as \'admin\' after decryption so we move to else condition.\nBut they have some Vullnerabilities. See the Below links(Exploiting the Vulnerabilities)\nIn Those 3 conditions\n1 Provides us Reading rights of Flag(Reading authorization)\n2 Provides us Writing rights of Flag(Writing authorization)\n\nNow the nameÂ authrwÂ is making senseÂ authrization for Reading and Writing\nDefending our services is also important. So we have toÂ patchÂ the Vulnerabilities.', '571f4ece86a967e3530ef0137c8e259f', 'crypto', 'own', '2019-02-03 03:03:35', 1);
INSERT INTO `stories` (`story_id`, `user_id`, `title`, `story`, `plain_story`, `story_unique_hash`, `category`, `story_type`, `time`, `valid`) VALUES
(16, 28, 'Basic Forensics', '&lt;h1&gt;Forensics Writeup:&lt;/h1&gt;\n&lt;p&gt;Here Are The Writeups Of Five Forensics Challenges From InvaderCTF&lt;/p&gt;\n&lt;h1&gt;&amp;nbsp;&lt;/h1&gt;\n&lt;h1&gt;1. Easy Peasy (150)&lt;/h1&gt;\n&lt;h2&gt;&amp;nbsp;&lt;/h2&gt;\n&lt;h2&gt;Don\'t Mess The Things Up...!&lt;/h2&gt;\n&lt;p&gt;In This Challenge You\'ll Find A QR Code.Scan QR Code.&lt;/p&gt;\n&lt;p&gt;After Scanning The QR Code We\'ll Get: &quot;w3lc0m3_70_1nVd3r_CtFstrings challenge.png&quot;&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51113676-d0a8e980-1828-11e9-8005-931a40a131a9.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51113676-d0a8e980-1828-11e9-8005-931a40a131a9.png&quot; alt=&quot;screenshot from 2019-01-14 18-06-52&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;But Actually Here There Is A Main Hint &quot;Strings&quot;.Strings Is a Linux Command Which will Give Us All Readable Strings In That Image&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51114044-1fa34e80-182a-11e9-867a-a75b6019d9e7.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51114044-1fa34e80-182a-11e9-867a-a75b6019d9e7.png&quot; alt=&quot;screenshot from 2019-01-14 18-07-19&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Something Is Weird Right...! Actually It Is Base32 Encoding,So Simply Decoding It Gives You The Flag&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51114062-2cc03d80-182a-11e9-8637-ea1931525d99.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51114062-2cc03d80-182a-11e9-8637-ea1931525d99.png&quot; alt=&quot;screenshot from 2019-01-14 18-08-03&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Flag: \'invader{345y_P34sY_l3m0n_Squ33zy!!}\'&lt;/p&gt;\n&lt;p&gt;.Simplest Challenge.But This Challenge Has Got Many Wrong Submissions.....Lol :)&lt;/p&gt;\n&lt;h1&gt;&amp;nbsp;&lt;/h1&gt;\n&lt;h1&gt;Dirty Room (100)&lt;/h1&gt;\n&lt;p&gt;In This Challenge Linux Users Will Face Extraction Problem, Actually It Was An Intended One, I Changed Magical Numbers Of Zip File.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51114909-b2dd8380-182c-11e9-9874-b3cbbb217db5.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51114909-b2dd8380-182c-11e9-9874-b3cbbb217db5.png&quot; alt=&quot;screenshot from 2019-01-14 18-36-09&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;So, Inorder to Extract It You\'ve To Change &quot;11 91&quot; with &quot;50 4B&quot; (Magical Numbers Of Zip File: 50 4B 03 04),SO after Changing Magical Numbers You Can Extract The Zip.&lt;/p&gt;\n&lt;p&gt;After Unzipping you\'ll Find Some Random Images, Among Those U Can See A Password. Now We\'ve The Password,But What To Do With That.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51114919-bb35be80-182c-11e9-9b81-9c6741dbe6aa.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51114919-bb35be80-182c-11e9-9b81-9c6741dbe6aa.png&quot; alt=&quot;screenshot from 2019-01-14 18-38-22&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;If U Can Observe Clearly There Is An Image(\'maxeresdefault(1).jpeg\') Which Doesn\'t Showup. Using Linux Command &quot;File&quot; We Can Find The Type Of File &lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51114933-c688ea00-182c-11e9-85f7-e258bc4cda74.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51114933-c688ea00-182c-11e9-85f7-e258bc4cda74.png&quot; alt=&quot;screenshot from 2019-01-14 18-44-05&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Woww...! It\'s A Zip File.Change Image Extension &quot;jpeg&quot; To &quot;zip&quot;.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51114941-cd176180-182c-11e9-9527-7ba2226566cc.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51114941-cd176180-182c-11e9-9527-7ba2226566cc.png&quot; alt=&quot;screenshot from 2019-01-14 18-44-12&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Now Try to Unzip The File. It\'ll Prompt For Password.Hey...! We\'ve A Password Right? Enter The Password, You\'ll Get The Flag :)&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51114952-d4d70600-182c-11e9-838d-2070748181bc.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51114952-d4d70600-182c-11e9-838d-2070748181bc.png&quot; alt=&quot;screenshot from 2019-01-14 18-45-00&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Flag : \'invader{1_l0v3_f1l3_f0r3n51c5}\'&lt;/p&gt;\n&lt;h1&gt;&amp;nbsp;&lt;/h1&gt;\n&lt;h1&gt;Dig Deeper (300)&lt;/h1&gt;\n&lt;p&gt;In This Challenge You\'ll Have An Image With A Hint&lt;/p&gt;\n&lt;h1&gt;&amp;nbsp;&lt;/h1&gt;\n&lt;h1&gt;Hint&lt;/h1&gt;\n&lt;p&gt;we use &quot;nopassword&quot; to dig more...............&lt;/p&gt;\n&lt;p&gt;Now We\'ve A Password &quot;nopassword&quot;, And We\'ve An Image.&lt;/p&gt;\n&lt;p&gt;So Try Steganography(It Is An Art Of Hiding Data)&lt;/p&gt;\n&lt;p&gt;We\'ve Many Online Tools For Steganography. But I\'ve Steghide.&lt;/p&gt;\n&lt;p&gt;So Trying Steghide Will Give U A File Named &quot;Flag.txt&quot;. But Inside You\'ll Find &quot;You can\'t find flag here.Better dig once again&quot; Sorry Just For Fun :)&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51116548-73656600-1831-11e9-8362-9d36d39bba9c.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51116548-73656600-1831-11e9-8362-9d36d39bba9c.png&quot; alt=&quot;screenshot from 2019-01-14 19-11-05&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;So There Trying Strings, And Other Commands Will Leave U No Clue.So There Is Nothing Inside&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51116550-73fdfc80-1831-11e9-9fce-94783421db02.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51116550-73fdfc80-1831-11e9-9fce-94783421db02.png&quot; alt=&quot;screenshot from 2019-01-14 19-13-24&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Try to Analyse The Given Zip File. Using Binwalk(Linux Command To Show Embedded Files In A File) You\'ll Find An Image. (Command: binwalk Challenge3.zip)&lt;/p&gt;\n&lt;p&gt;Now Try To Extract Image (Command: binwalk --dd=\'.*\' Challenge3.zip).&lt;/p&gt;\n&lt;p&gt;Now Try Steganography On This Image With Given Password.&lt;/p&gt;\n&lt;p&gt;You\'ll Get Flag.txt, containing &quot;Yeah Man...! You nailed it You Deserve The Flag. Here You Are Link:&lt;a href=&quot;https://drive.google.com/open?id=12OMTbBiJ0oXsukdcnypE_S3mlqBgN9NU&quot; rel=&quot;nofollow&quot;&gt;https://drive.google.com/open?id=12OMTbBiJ0oXsukdcnypE_S3mlqBgN9NU&lt;/a&gt;&quot;&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51116556-76f8ed00-1831-11e9-8346-5848e60024b7.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51116556-76f8ed00-1831-11e9-8346-5848e60024b7.png&quot; alt=&quot;screenshot from 2019-01-14 19-14-41&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Using Link We\'ll Get Flag&lt;/p&gt;\n&lt;p&gt;Flag : invader{W3LCoM3_70_F0r3N51C5}&lt;/p&gt;\n&lt;h1&gt;&amp;nbsp;&lt;/h1&gt;\n&lt;h1&gt;Long Walk To Freedom&lt;/h1&gt;\n&lt;p&gt;We\'ve An Audio File &amp;amp; Image&lt;/p&gt;\n&lt;p&gt;Search For Audio Forensics.You\'ll Find Many Tools &amp;amp; Now I\'ll be using Audacity.&lt;/p&gt;\n&lt;p&gt;Open Audio File With Audacity.You\'ll get Waveform Of Audio&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51118752-1ff61680-1837-11e9-8878-5aa80b9a282d.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51118752-1ff61680-1837-11e9-8878-5aa80b9a282d.png&quot; alt=&quot;screenshot from 2019-01-14 19-47-58&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Change It To Spectrogram.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51118754-208ead00-1837-11e9-894f-e11535261b0c.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51118754-208ead00-1837-11e9-894f-e11535261b0c.png&quot; alt=&quot;screenshot from 2019-01-14 19-48-17&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&quot;5h1zuk4_143&quot; (Shizuka_143)...A Password It Seems.We\'ve An Image Too.Soo Try Steganograpy&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51120364-ecb58680-183a-11e9-88e3-d42324c16751.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51120364-ecb58680-183a-11e9-88e3-d42324c16751.png&quot; alt=&quot;screenshot from 2019-01-14 19-51-51&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Wow ....! It Returned Redirect.txt &amp;amp; We\'ve A Mediafire Link,It Gives Us &quot;Nobitha.mp3&quot;&lt;/p&gt;\n&lt;p&gt;Listen To It Once,This Sound Indicates Morse Code In It.&lt;/p&gt;\n&lt;p&gt;We\'ve A Online Decoder : \'&lt;a href=&quot;https://morsecode.scphillips.com/labs/audio-decoder-adaptive/&quot; rel=&quot;nofollow&quot;&gt;https://morsecode.scphillips.com/labs/audio-decoder-adaptive/&lt;/a&gt;\'&lt;/p&gt;\n&lt;p&gt;Upload Audio &amp;amp; Play.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51118756-21274380-1837-11e9-9486-ccdab4ff11e5.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51118756-21274380-1837-11e9-9486-ccdab4ff11e5.png&quot; alt=&quot;screenshot from 2019-01-14 19-55-10&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Decoded Text Is Full Of \'A\' &amp;amp; \'B\'. Search For Ciphers With \'A\' &amp;amp; \'B\'.&lt;/p&gt;\n&lt;p&gt;&quot;Baconian Cipher&quot;&lt;/p&gt;\n&lt;p&gt;Exclude &quot;QWZXWEDC&quot; And Decode It. Link: &quot;&lt;a href=&quot;http://rumkin.com/tools/cipher/baconian.php&quot; rel=&quot;nofollow&quot;&gt;http://rumkin.com/tools/cipher/baconian.php&lt;/a&gt;&quot;&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51118757-21bfda00-1837-11e9-916d-6a05f23d0a93.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51118757-21bfda00-1837-11e9-916d-6a05f23d0a93.png&quot; alt=&quot;screenshot from 2019-01-14 19-56-11&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Flag : invader{YOUHAVEGREATPATIENCE}&lt;/p&gt;\n&lt;h1&gt;&amp;nbsp;&lt;/h1&gt;\n&lt;h1&gt;Brain WhiteWash (550)&lt;/h1&gt;\n&lt;p&gt;Really Cool Challenge :)&lt;/p&gt;\n&lt;p&gt;We are Provided With A Zip File &amp;amp; Hint&lt;/p&gt;\n&lt;h1&gt;&amp;nbsp;&lt;/h1&gt;\n&lt;h1&gt;Hint :&lt;/h1&gt;\n&lt;p&gt;This Time A Little Bit Crypto :) Cipher Text: kyreb5wfiaf1exfli7urpvmvek4euefntfdzexk0tyrcc3exvefvhlrcjpdsfcjaljkgrjjnfiuzjtrktyd331wlt4ee==&lt;/p&gt;\n&lt;p&gt;It Is &quot;Caeser Cipher With Shift 17&quot; &amp;amp; Zip Password : &quot;catchm331fuc4nn&quot;&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125635-1379ba00-1847-11e9-9604-f27691bf1896.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125635-1379ba00-1847-11e9-9604-f27691bf1896.png&quot; alt=&quot;screenshot from 2019-01-14 21-45-50&quot; /&gt;&lt;/a&gt; Extract The Zip With Decoded Password. Inside You\'ll Find Three Files &quot;Chal.png&quot; Which Is Useless(Use Strings &amp;amp; you Can Find Waste Many A Times) , &quot;MainHint.txt&quot; Which Is Full Of Binaries &amp;amp; Finally &quot;No Security In This World&quot;.&lt;/p&gt;\n&lt;p&gt;Consider &quot;MainHint.txt&quot;.Use LSB(Least Significant Bits Of Each Binary) And Decode It.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125650-15dc1400-1847-11e9-85de-aed2336f946b.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125650-15dc1400-1847-11e9-85de-aed2336f946b.png&quot; alt=&quot;screenshot from 2019-01-14 21-53-56&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Code For Decoding&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125636-14125080-1847-11e9-8c1b-aab6d1390c79.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125636-14125080-1847-11e9-8c1b-aab6d1390c79.png&quot; alt=&quot;screenshot from 2019-01-14 21-50-09&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Woww...! &quot;snowstegisawesome&quot;.&lt;/p&gt;\n&lt;p&gt;I Guess It Is Related To Snow Steganography.&lt;/p&gt;\n&lt;p&gt;Then What About The Other File...?&lt;/p&gt;\n&lt;p&gt;Run Binwalk. You\'ll Find A JPEG File Extract It. &lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125639-14125080-1847-11e9-95e0-a2cdb30930f8.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125639-14125080-1847-11e9-95e0-a2cdb30930f8.png&quot; alt=&quot;screenshot from 2019-01-14 21-50-53&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;But This Time We Only Have Image Bt No Password..... :(&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125641-14125080-1847-11e9-8699-415955c33c84.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125641-14125080-1847-11e9-8699-415955c33c84.png&quot; alt=&quot;screenshot from 2019-01-14 21-51-59&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Wait..! What Was The File Name &quot;No Security In This World&quot;. I Guess There Is no Password.&lt;/p&gt;\n&lt;p&gt;Yeah Extracted Hint File. &lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125644-14aae700-1847-11e9-87a7-cd4c85cb1e96.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125644-14aae700-1847-11e9-87a7-cd4c85cb1e96.png&quot; alt=&quot;screenshot from 2019-01-14 21-52-24&quot; /&gt;&lt;/a&gt; In The Begining I Thought It Was Empty. &lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125645-14aae700-1847-11e9-9c25-9b0cb04a9d31.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125645-14aae700-1847-11e9-9c25-9b0cb04a9d31.png&quot; alt=&quot;screenshot from 2019-01-14 21-52-43&quot; /&gt;&lt;/a&gt; But In The End We\'ve A Clue.Which Won\'t Help Us.&lt;/p&gt;\n&lt;p&gt;Hold on...! Challenge Name &quot;Brain WhiteWash&quot; Right....&lt;/p&gt;\n&lt;p&gt;Yeah If u Have Really Enquired Abt Stegsnow,You Could Easily Find It Out What It Is.It Is White Space Steganography&lt;/p&gt;\n&lt;p&gt;See This Is White Space Stego.Really The Best Stego Ever.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125646-15437d80-1847-11e9-9410-3b10a3a96180.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125646-15437d80-1847-11e9-9410-3b10a3a96180.png&quot; alt=&quot;screenshot from 2019-01-14 21-52-52&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Using Snow Steg &amp;amp; Password We can Retreive The Flag.&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://user-images.githubusercontent.com/46676598/51125648-15437d80-1847-11e9-9623-b6be3f8c22de.png&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;&lt;img style=&quot;max-width: 100%;&quot; src=&quot;https://user-images.githubusercontent.com/46676598/51125648-15437d80-1847-11e9-9623-b6be3f8c22de.png&quot; alt=&quot;screenshot from 2019-01-14 21-53-32&quot; /&gt;&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Flag: \'invader{W0W_Y0u_h4v3_gr34t_futur3}\'&lt;/p&gt;', 'Forensics Writeup:\n\nHere Are The Writeups Of Five Forensics Challenges From InvaderCTF\n\n1. Easy Peasy (150)\nDon\'t Mess The Things Up...!\n\nIn This Challenge You\'ll Find A QR Code.Scan QR Code.\n\nAfter Scanning The QR Code We\'ll Get: &quot;w3lc0m3_70_1nVd3r_CtFstrings challenge.png&quot;\n\nBut Actually Here There Is A Main Hint &quot;Strings&quot;.Strings Is a Linux Command Which will Give Us All Readable Strings In That Image\n\nSomething Is Weird Right...! Actually It Is Base32 Encoding,So Simply Decoding It Gives You The Flag\n\nFlag: \'invader{345y_P34sY_l3m0n_Squ33zy!!}\'\n\n.Simplest Challenge.But This Challenge Has Got Many Wrong Submissions.....Lol :)\n\nDirty Room (100)\n\nIn This Challenge Linux Users Will Face Extraction Problem, Actually It Was An Intended One, I Changed Magical Numbers Of Zip File.\n\nSo, Inorder to Extract It You\'ve To Change &quot;11 91&quot; with &quot;50 4B&quot; (Magical Numbers Of Zip File: 50 4B 03 04),SO after Changing Magical Numbers You Can Extract The Zip.\n\nAfter Unzipping you\'ll Find Some Random Images, Among Those U Can See A Password. Now We\'ve The Password,But What To Do With That.\n\nIf U Can Observe Clearly There Is An Image(\'maxeresdefault(1).jpeg\') Which Doesn\'t Showup. Using Linux Command &quot;File&quot; We Can Find The Type Of File \n\nWoww...! It\'s A Zip File.Change Image Extension &quot;jpeg&quot; To &quot;zip&quot;.\n\nNow Try to Unzip The File. It\'ll Prompt For Password.Hey...! We\'ve A Password Right? Enter The Password, You\'ll Get The Flag :)\n\nFlag : \'invader{1_l0v3_f1l3_f0r3n51c5}\'\n\nDig Deeper (300)\n\nIn This Challenge You\'ll Have An Image With A Hint\n\nHint\n\nwe use &quot;nopassword&quot; to dig more...............\n\nNow We\'ve A Password &quot;nopassword&quot;, And We\'ve An Image.\n\nSo Try Steganography(It Is An Art Of Hiding Data)\n\nWe\'ve Many Online Tools For Steganography. But I\'ve Steghide.\n\nSo Trying Steghide Will Give U A File Named &quot;Flag.txt&quot;. But Inside You\'ll Find &quot;You can\'t find flag here.Better dig once again&quot; Sorry Just For Fun :)\n\nSo There Trying Strings, And Other Commands Will Leave U No Clue.So There Is Nothing Inside\n\nTry to Analyse The Given Zip File. Using Binwalk(Linux Command To Show Embedded Files In A File) You\'ll Find An Image. (Command: binwalk Challenge3.zip)\n\nNow Try To Extract Image (Command: binwalk --dd=\'.*\' Challenge3.zip).\n\nNow Try Steganography On This Image With Given Password.\n\nYou\'ll Get Flag.txt, containing &quot;Yeah Man...! You nailed it You Deserve The Flag. Here You Are Link:https://drive.google.com/open?id=12OMTbBiJ0oXsukdcnypE_S3mlqBgN9NU&quot;\n\nUsing Link We\'ll Get Flag\n\nFlag : invader{W3LCoM3_70_F0r3N51C5}\n\nLong Walk To Freedom\n\nWe\'ve An Audio File &amp; Image\n\nSearch For Audio Forensics.You\'ll Find Many Tools &amp; Now I\'ll be using Audacity.\n\nOpen Audio File With Audacity.You\'ll get Waveform Of Audio\n\nChange It To Spectrogram.\n\n&quot;5h1zuk4_143&quot; (Shizuka_143)...A Password It Seems.We\'ve An Image Too.Soo Try Steganograpy\n\nWow ....! It Returned Redirect.txt &amp; We\'ve A Mediafire Link,It Gives Us &quot;Nobitha.mp3&quot;\n\nListen To It Once,This Sound Indicates Morse Code In It.\n\nWe\'ve A Online Decoder : \'https://morsecode.scphillips.com/labs/audio-decoder-adaptive/\'\n\nUpload Audio &amp; Play.\n\nDecoded Text Is Full Of \'A\' &amp; \'B\'. Search For Ciphers With \'A\' &amp; \'B\'.\n\n&quot;Baconian Cipher&quot;\n\nExclude &quot;QWZXWEDC&quot; And Decode It. Link: &quot;http://rumkin.com/tools/cipher/baconian.php&quot;\n\nFlag : invader{YOUHAVEGREATPATIENCE}\n\nBrain WhiteWash (550)\n\nReally Cool Challenge :)\n\nWe are Provided With A Zip File &amp; Hint\n\nHint :\n\nThis Time A Little Bit Crypto :) Cipher Text: kyreb5wfiaf1exfli7urpvmvek4euefntfdzexk0tyrcc3exvefvhlrcjpdsfcjaljkgrjjnfiuzjtrktyd331wlt4ee==\n\nIt Is &quot;Caeser Cipher With Shift 17&quot; &amp; Zip Password : &quot;catchm331fuc4nn&quot;\n\n Extract The Zip With Decoded Password. Inside You\'ll Find Three Files &quot;Chal.png&quot; Which Is Useless(Use Strings &amp; you Can Find Waste Many A Times) , &quot;MainHint.txt&quot; Which Is Full Of Binaries &amp; Finally &quot;No Security In This World&quot;.\n\nConsider &quot;MainHint.txt&quot;.Use LSB(Least Significant Bits Of Each Binary) And Decode It.\n\nCode For Decoding\n\nWoww...! &quot;snowstegisawesome&quot;.\n\nI Guess It Is Related To Snow Steganography.\n\nThen What About The Other File...?\n\nRun Binwalk. You\'ll Find A JPEG File Extract It. \n\nBut This Time We Only Have Image Bt No Password..... :(\n\nWait..! What Was The File Name &quot;No Security In This World&quot;. I Guess There Is no Password.\n\nYeah Extracted Hint File.  In The Begining I Thought It Was Empty.  But In The End We\'ve A Clue.Which Won\'t Help Us.\n\nHold on...! Challenge Name &quot;Brain WhiteWash&quot; Right....\n\nYeah If u Have Really Enquired Abt Stegsnow,You Could Easily Find It Out What It Is.It Is White Space Steganography\n\nSee This Is White Space Stego.Really The Best Stego Ever.\n\nUsing Snow Steg &amp; Password We can Retreive The Flag.\n\nFlag: \'invader{W0W_Y0u_h4v3_gr34t_futur3}\'', '7fe6c3f642b229faa8994e31674c2df0', 'forensics', 'own', '2019-02-03 03:12:35', 1);

-- --------------------------------------------------------

--
-- Table structure for table `stories_complaints`
--

CREATE TABLE `stories_complaints` (
  `complaint_user_id` int(11) NOT NULL,
  `story_id` int(11) NOT NULL,
  `story_user_id` int(11) NOT NULL,
  `status` tinyint(1) NOT NULL DEFAULT '0',
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `story_categories`
--

CREATE TABLE `story_categories` (
  `story_id` int(11) NOT NULL,
  `category` varchar(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `story_categories`
--

INSERT INTO `story_categories` (`story_id`, `category`) VALUES
(7, 'crypto'),
(8, 'web'),
(9, 'pwn'),
(10, 're'),
(11, 'forensics'),
(12, 'misc'),
(13, 'pro'),
(14, 'pwn'),
(14, 're'),
(15, 'crypto'),
(16, 'forensics');

-- --------------------------------------------------------

--
-- Table structure for table `users`
--

CREATE TABLE `users` (
  `user_id` int(11) NOT NULL,
  `user_name` varchar(100) NOT NULL,
  `user_email` varchar(100) NOT NULL,
  `user_image` varchar(200) DEFAULT 'user.png',
  `password` varchar(100) NOT NULL,
  `signup_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `is_active` tinyint(1) NOT NULL DEFAULT '0',
  `score` int(11) NOT NULL DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `users`
--

INSERT INTO `users` (`user_id`, `user_name`, `user_email`, `user_image`, `password`, `signup_time`, `is_active`, `score`) VALUES
(1, 'KasiReddy', 'duggempudi111@gmail.com', 'user.png', '2f40377ad146ed9c6633b677fc5ef84f', '2018-09-17 04:02:54', 0, 300),
(2, 'n', '12@gmail.com', 'user.png', '25d55ad283aa400af464c76d713c07ad', '2018-09-17 06:24:49', 0, 0),
(3, 'MVSatyam', 'mvsatyam606@gmail.com', 'user.png', '54a63d968cfefd373f0fd57e7f196218', '2018-09-17 08:47:29', 0, 0),
(4, 'Satya', 'rudrarajusatyavarma@gmail.com', 'a87ff679a2f3e71d9181a67b7542122c_o.jpg', 'e6f5017b6c1335d758889951c6ebc888', '2018-09-17 10:47:03', 0, 0),
(5, 'ajay', 'n141011@rguktn.ac.in', 'user.png', '25d55ad283aa400af464c76d713c07ad', '2018-09-17 11:02:35', 0, 0),
(6, 'Vinod', 'vinodyedla678@gmail.com', 'user.png', '4e5faacf52291871fe6a5aeec38e1f2b', '2018-09-17 15:04:01', 0, 0),
(7, 'swetha', 'tswetha352@gmal.com', 'user.png', 'e1a0bff1cce68eac85e42942c5dda564', '2018-09-17 15:27:13', 0, 0),
(8, 'swetha', 'tswetha352@gmail.com', 'user.png', 'e1a0bff1cce68eac85e42942c5dda564', '2018-09-17 15:30:02', 0, 0),
(9, 'Gayathri', 'gaya.amma@gmail.com', 'user.png', 'a7761de0787dd387f1ba2dc5bb886629', '2018-09-17 15:52:49', 0, 0),
(10, 'nagamanikanta', 'manichummadi747@gmail.com', 'user.png', '7d4b0081ce4ecc2c4c6f4a587d42d61c', '2018-09-18 04:53:44', 0, 0),
(11, 'deekshitha', 'deekshiatti@gmail.com', 'user.png', '02760c718327079efab31b2104d959d4', '2018-09-18 06:09:27', 0, 0),
(12, 'Ameena', 'shaikameena333@gmail.com', 'user.png', '04eb7829189876000b38e4e6be29190c', '2018-09-18 06:37:07', 0, 0),
(13, 'vinodkumar', 'vinodkumarmuppera@gmail.com', 'user.png', 'f2d026a241aba6ee7b97e655e935db94', '2018-09-18 08:02:43', 0, 0),
(14, 'lucky', 'lucky@gmail.com', 'user.png', '25d55ad283aa400af464c76d713c07ad', '2018-09-18 16:20:50', 0, 0),
(15, 'Niranjan', 'niranjangottam199221@gmail.com', 'user.png', '2ae29d4b7a3ba90ada8bfb95e2a8d852', '2018-09-19 11:33:02', 0, 0),
(16, 'Devdatta supnekar', 'devdattasupnekar.ds@gmail.com', 'user.png', '256d957c7aa7b9b3aa4e15dfa6f131b0', '2018-09-21 14:04:23', 0, 0),
(17, 'jagadesh', 'jagasdsadfdffa@gmail.com', 'user.png', '6f527af6690c57d0283d87350ce03c29', '2018-09-30 19:16:53', 0, 0),
(18, 'jagadesh', 'jagadesh1@gmail.com', 'user.png', '6f527af6690c57d0283d87350ce03c29', '2018-09-30 19:17:33', 0, 0),
(19, 'sri harsha', 'harsha.surapaneni11@gmail.com', 'user.png', '724126829bc4b9a571575354f917c9c6', '2018-10-03 09:06:05', 0, 0),
(20, 'Pravallika', 'pravallika1@gmail.com', 'user.png', '801eaa465392e41d95807b11811338f1', '2018-10-03 10:26:17', 0, 0),
(21, 'RevanthKumar', 'revanth1@gmail.com', 'user.png', '4c39b062e6f79792fa91c3d7ddf07b18', '2018-10-03 10:40:38', 0, 0),
(22, 'Ragavendra', 'ragavendra1@gmail.com', 'user.png', 'e0e1d1b118aaa99b43e8c4e84dad89d2', '2018-10-03 10:48:27', 0, 0),
(23, 'Mohan srk', 'pedhapatimohansrirammakrishna@gmail.com', 'user.png', 'f1f7d48b1dc306ae10601b42b317d90e', '2018-10-04 11:51:39', 0, 0),
(24, 'Kanti Reddy', 'kntirmy9@gmail.com', 'user.png', '3bfbecaab2c3f7421513f6daa21a7648', '2018-10-19 18:47:14', 0, 0),
(25, 'Rathod Srinu', 'srinusrinivas847@gmail.com', 'user.png', '4e2e41f68681936c6f9a4788f1e0604e', '2018-11-10 01:07:15', 0, 0),
(26, 'Davidson', 'harish.eagle623@gmail.com', 'user.png', '4175d86b85ceaeda14e35ff83caa105a', '2018-11-11 05:12:12', 0, 0),
(27, 'sravan', 'sravan@gmail.com', 'user.png', '2f4cad9a71db95765f9b5c27c378aadf', '2019-02-02 17:21:20', 0, 900),
(28, 's1r1u5', 'n151140@rguktn.ac.in', 'user.png', 'b04d96ea22a25aae1e11a5f7d58d5ea1', '2019-02-03 01:34:38', 0, 300);

-- --------------------------------------------------------

--
-- Table structure for table `views`
--

CREATE TABLE `views` (
  `story_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `views`
--

INSERT INTO `views` (`story_id`, `user_id`, `time`) VALUES
(5, 27, '2019-02-02 18:02:08'),
(6, 27, '2019-02-02 18:18:33'),
(11, 27, '2019-02-02 19:06:29'),
(12, 27, '2019-02-02 20:54:30'),
(13, 1, '2019-02-03 01:03:35'),
(14, 1, '2019-02-03 02:56:44'),
(15, 1, '2019-02-03 03:03:43');

-- --------------------------------------------------------

--
-- Table structure for table `visitors`
--

CREATE TABLE `visitors` (
  `visitor_ip` varchar(20) NOT NULL,
  `visit_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `writeups`
--

CREATE TABLE `writeups` (
  `write_id` int(11) NOT NULL,
  `story` text NOT NULL,
  `user_id` int(11) NOT NULL,
  `status` tinyint(1) NOT NULL DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Dumping data for table `writeups`
--

INSERT INTO `writeups` (`write_id`, `story`, `user_id`, `status`) VALUES
(1, '&lt;p&gt;aksjh akhd kajsh dkashd kajsh dkjashdkja jshd&amp;nbsp;&lt;/p&gt;', 1, 0);

--
-- Indexes for dumped tables
--

--
-- Indexes for table `admin`
--
ALTER TABLE `admin`
  ADD PRIMARY KEY (`admin_id`),
  ADD UNIQUE KEY `admin_email` (`admin_email`);

--
-- Indexes for table `chat`
--
ALTER TABLE `chat`
  ADD KEY `sent_by` (`sent_by`),
  ADD KEY `sent_to` (`sent_to`);

--
-- Indexes for table `feedback`
--
ALTER TABLE `feedback`
  ADD PRIMARY KEY (`user_id`),
  ADD UNIQUE KEY `user_id` (`user_id`,`feedback`);

--
-- Indexes for table `followers`
--
ALTER TABLE `followers`
  ADD UNIQUE KEY `followed_by` (`followed_by`,`following`),
  ADD KEY `following` (`following`);

--
-- Indexes for table `friend_requests`
--
ALTER TABLE `friend_requests`
  ADD UNIQUE KEY `sent_by` (`sent_by`,`sent_to`),
  ADD KEY `sent_to` (`sent_to`);

--
-- Indexes for table `likes`
--
ALTER TABLE `likes`
  ADD KEY `user_id` (`user_id`),
  ADD KEY `story_id` (`story_id`) USING BTREE;

--
-- Indexes for table `stories`
--
ALTER TABLE `stories`
  ADD PRIMARY KEY (`story_id`),
  ADD UNIQUE KEY `story_unique_hash` (`story_unique_hash`),
  ADD KEY `user_id` (`user_id`);

--
-- Indexes for table `stories_complaints`
--
ALTER TABLE `stories_complaints`
  ADD KEY `complaint_user_id` (`complaint_user_id`),
  ADD KEY `story_id` (`story_id`),
  ADD KEY `story_user_id` (`story_user_id`);

--
-- Indexes for table `story_categories`
--
ALTER TABLE `story_categories`
  ADD KEY `story_id` (`story_id`);

--
-- Indexes for table `users`
--
ALTER TABLE `users`
  ADD PRIMARY KEY (`user_id`),
  ADD UNIQUE KEY `user_email` (`user_email`);

--
-- Indexes for table `views`
--
ALTER TABLE `views`
  ADD UNIQUE KEY `story_id` (`story_id`,`user_id`),
  ADD KEY `user_id` (`user_id`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `admin`
--
ALTER TABLE `admin`
  MODIFY `admin_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;
--
-- AUTO_INCREMENT for table `stories`
--
ALTER TABLE `stories`
  MODIFY `story_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=17;
--
-- AUTO_INCREMENT for table `users`
--
ALTER TABLE `users`
  MODIFY `user_id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=29;
--
-- Constraints for dumped tables
--

--
-- Constraints for table `chat`
--
ALTER TABLE `chat`
  ADD CONSTRAINT `chat_ibfk_1` FOREIGN KEY (`sent_by`) REFERENCES `users` (`user_id`),
  ADD CONSTRAINT `chat_ibfk_2` FOREIGN KEY (`sent_to`) REFERENCES `users` (`user_id`);

--
-- Constraints for table `feedback`
--
ALTER TABLE `feedback`
  ADD CONSTRAINT `feedback_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`);

--
-- Constraints for table `friend_requests`
--
ALTER TABLE `friend_requests`
  ADD CONSTRAINT `friend_requests_ibfk_1` FOREIGN KEY (`sent_by`) REFERENCES `users` (`user_id`),
  ADD CONSTRAINT `friend_requests_ibfk_2` FOREIGN KEY (`sent_to`) REFERENCES `users` (`user_id`);

--
-- Constraints for table `likes`
--
ALTER TABLE `likes`
  ADD CONSTRAINT `likes_ibfk_1` FOREIGN KEY (`story_id`) REFERENCES `stories` (`story_id`),
  ADD CONSTRAINT `likes_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`);

--
-- Constraints for table `stories`
--
ALTER TABLE `stories`
  ADD CONSTRAINT `stories_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`);

--
-- Constraints for table `stories_complaints`
--
ALTER TABLE `stories_complaints`
  ADD CONSTRAINT `stories_complaints_ibfk_1` FOREIGN KEY (`complaint_user_id`) REFERENCES `users` (`user_id`),
  ADD CONSTRAINT `stories_complaints_ibfk_2` FOREIGN KEY (`story_id`) REFERENCES `stories` (`story_id`),
  ADD CONSTRAINT `stories_complaints_ibfk_3` FOREIGN KEY (`story_user_id`) REFERENCES `users` (`user_id`);

--
-- Constraints for table `story_categories`
--
ALTER TABLE `story_categories`
  ADD CONSTRAINT `story_categories_ibfk_1` FOREIGN KEY (`story_id`) REFERENCES `stories` (`story_id`);

--
-- Constraints for table `views`
--
ALTER TABLE `views`
  ADD CONSTRAINT `views_ibfk_1` FOREIGN KEY (`story_id`) REFERENCES `stories` (`story_id`),
  ADD CONSTRAINT `views_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`);
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
